<!DOCTYPE html>
<html>
<head>
  <title><%= content_for?(:title) ? "#{settings.site_name} | #{yield(:title)}" : settings.site_name %></title>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
  <![endif]-->
  <%= stylesheet_link_tag "application", :media => "all" %>
  <% if settings.favicon %>
    <%= favicon_link_tag settings.favicon.url %>
  <% end %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <% unless settings.ga_code.blank? %>
    <script>var _gaq=[['_setAccount','<%= settings.ga_code %>'],['_trackPageview']];(function(d, t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g, s);}(document,'script'));</script>
  <% end %>
</head>
<body>
  <div id="holder">

    <div class="container">
		  <div class="row">

        <div class="page-header" id="header">
          <h1><%= link_to settings.site_name, root_url %></h1>
          
          <nav id="main-nav">
            <ul class="main">
              <% podcasts.each do |podcast| %>
                <li><%= link_to podcast.name, podcast %></li>
              <% end %>
            </ul><!-- /main -->
          </nav><!-- /main-nav -->

          <nav id="mobile-nav">
            <div class="pull-left menu">
              <a class="button">Menu</a>
              <div class="container">
                <ul class="main">
                  <% podcasts.each do |podcast| %>
                    <li><%= link_to podcast.name, podcast %></li>
                  <% end %>
                  <li><a href="#">•••</a></li>
                  <% pages.each do |page| %>
                    <li><%= link_to page.title, page %></li>
                  <% end %>
                  <li><a href="#">•••</a></li>
                  <% podcasts.each do |podcast| %>
                    <li><%= link_to "#{podcast.name} RSS Feed", podcast_feed_path(podcast) %></li>
                    <% unless podcast.itunes_link.blank?  %>
                      <li><%= link_to "#{podcast.name} in iTunes", podcast.itunes_link %></li>
                    <% end %>
                  <% end %>
                </ul><!-- /main -->
              </div><!-- /container -->
            </div><!-- /menu -->
            <div class="pull-right search">
              <a class="button"></a>
              <div class="container">
                <%= form_for @search, html: { :class => 'search' } do |f| %>
                  <%= f.text_field :title_or_description_contains, :placeholder => "Search..."  %>
                <% end %>
              </div><!-- /container -->
            </div><!-- /search -->
          </nav><!-- /mobile-nav -->

          <nav id="sub-nav">
            <% unless pages.size == 0 %>
            <ul class="main pull-left">
              <% pages.each do |page| %>
                <li><%= link_to page.title, page %></li>
              <% end %>
            </ul><!-- /main -->
            <% end %>

            <%= form_for @search, html: { :class => 'search' } do |f| %>
              <%= f.text_field :title_or_description_contains, :class => "pull-right", 
                               :placeholder => "Search..."  %>
             <% end %>
          </nav><!-- /sub-nav -->

          <div class="clearfix"></div>
        </div><!-- /page-header -->

        <% if user_signed_in? %>
          <div class="span11">
            <ul class="nav nav-tabs">
              <li class="<%= 'active' if params[:controller] == "blogrolls" %>">
                <%= link_to "Blogroll", blogrolls_path %>
              </li>
              <li class="<%= 'active' if (params[:controller] == "pages") && (params[:action] != "show") %>">
                <%= link_to "Pages", pages_path %>
              </li>
              <li class="<%= 'active' if ((params[:controller] == "podcasts") && (params[:action] != "show") ||
                                          (params[:controller] == "episodes") && (params[:action] != ("index" || "show"))) %>">
                <%= link_to "Podcasts", podcasts_path %>
              </li>
              <li class="<%= 'active' if params[:controller] == "settings" %>">
                <%= link_to "Settings", settings_path %>
              </li>
              <li class="<%= 'active' if params[:controller] == "users" %>">
                <%= link_to "Users", users_path %>
              </li>
              <li class="pull-right">
                <%= link_to "Logout", destroy_user_session_path, method: :delete %>
              </li>
              <li class="pull-right">
                <p><%= current_user.email %></p>
              </li>
            </ul><!-- /nav -->
          </div><!-- /span11 -->
        <% end %>
      
        <div class="span11">
        <% if notice %>
          <div class="alert alert-success">
            <%= notice %>
          </div>
        <% end %>
        <% if alert %>
          <div class="alert">
            <%= alert %>
          </div>
        <% end %>
        </div>

        <% if content_for?(:banner) %>
          <div class="span11">
            <div class="hero-unit" id="banner">
              <%= yield(:banner) %>
            </div><!-- /hero-unit -->
            <% if content_for?(:banner_alt) %>
              <div class="hero-unit" id="banner_alt">
                <%= yield(:banner_alt) %>
              </div><!-- /hero-unit -->
            <% end %>
          </div><!-- /span -->
        <% end %>

        <%= @sidebar ? raw("<div class=\"span7\">") : raw("<div class=\"span11\">") %>
          <%= yield %>
        </div><!-- /span -->

        <% if @sidebar %>
          <div class="span4" id="sidebar">
            <%= render @sidebar %>
          </div><!-- /span4 -->
        <% end %>

		  </div><!-- /row -->
	 </div><!-- /container -->

    <div class="footer">
      <div class="container">
        <p>Copyright © <%= Date.today.strftime("%Y") %> <%= settings.site_name %>
          <% footer_pages.each do |page| %> 
            | <%= link_to page.title, page %>
          <% end %>
        </p>
      </div><!-- /container -->
    </div><!-- /footer -->

  </div><!-- holder -->

</body>
</html>