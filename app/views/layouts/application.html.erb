<!DOCTYPE html>
<html>
<head>
  <title><%= content_for?(:title) ? "#{settings.site_name} | #{yield(:title)}" : settings.site_name %></title>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
  <![endif]-->
  <%= stylesheet_link_tag "application", :media => "all" %>
  <% cache "favicon" do %>
    <% if settings.favicon.present? %>
      <%= favicon_link_tag settings.favicon.url %>
    <% end %>
  <% end %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <% if settings.flattr_username.present? %>
    <link rel="payment" href="https://flattr.com/submit/auto?url=<%= root_url %>&user_id=<%= u settings.flattr_username %>&title=<%= u settings.site_name %>&language=de_DE&category=audio" type="text/html" />
  <% end %>
  <meta name="google-site-verification" content="qpvA4wDnK1GUYsOa6qra7y_tX140G4ZId2JpHaznPjc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <% unless settings.ga_code.blank? %>
    <script>var _gaq=[['_setAccount','<%= settings.ga_code %>'],['_trackPageview']];(function(d, t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g, s);}(document,'script'));</script>
  <% end %>
</head>
<body>
  <div id="holder">

    <div class="container">
		  <div class="row">

        <div class="page-header" id="header">
          <h1><%= link_to settings.site_name, root_path %></h1>

          <nav id="main-nav">
            <ul class="main">
              <% cache "nav-podcasts" do %>
                <% podcasts.each do |podcast| %>
                  <li><%= link_to podcast.name, podcast %></li>
                <% end %>
              <% end %>
            </ul><!-- /main -->
          </nav><!-- /main-nav -->

          <nav id="mobile-nav">
            <div class="pull-left menu">
              <a class="button">Menu</a>
              <div class="container">
                <ul class="main">
                  <% cache "mobile-podcasts" do %>
                    <% podcasts.each do |podcast| %>
                      <li><%= link_to podcast.name, podcast %></li>
                    <% end %>
                  <% end %>
                  <% unless pages.size == 0 %>
                    <li><a href="#">•••</a></li>
                    <% cache "pages" do %>
                      <% pages.each do |page| %>
                        <li><%= link_to page.title, page %></li>
                      <% end %>
                    <% end %>
                  <% end %>
                  <li><a href="#">•••</a></li>
                  <% cache "mobile-subscribe-podcasts" do %>
                    <% podcasts.each do |podcast| %>
                      <li><%= link_to "#{podcast.name} RSS Feed", podcast_feed_path(podcast) %></li>
                      <% unless podcast.itunes_link.blank?  %>
                        <li><%= link_to "#{podcast.name} in iTunes", podcast.itunes_link %></li>
                      <% end %>
                    <% end %>
                  <% end %>
                </ul><!-- /main -->
              </div><!-- /container -->
            </div><!-- /menu -->
            <div class="pull-right search">
              <a class="button"></a>
              <div class="container">
                <% if params[:action] == "podcast_index" %>
                  <%= search_form_for @search, url: podcast_episodes_path, html: { class: 'search' } do |f| %>
                    <%= f.text_field :title_cont, placeholder: "Search..."  %>
                  <% end %>
                <% else %>
                  <%= search_form_for @search, html: { class: 'search' } do |f| %>
                    <%= f.text_field :title_or_description_cont, placeholder: "Search..."  %>
                  <% end %>
                <% end %>
              </div><!-- /container -->
            </div><!-- /search -->
          </nav><!-- /mobile-nav -->

          <nav id="sub-nav">
            <% unless pages.size == 0 %>
            <ul class="main pull-left">
              <% cache "pages" do %>
                <% pages.each do |page| %>
                  <li><%= link_to page.title, page %></li>
                <% end %>
              <% end %>
            </ul><!-- /main -->
            <% end %>
            <% if params[:action] == "podcast_index" %>
              <%= search_form_for @search, url: podcast_episodes_path, html: { class: 'search' } do |f| %>
                <%= f.text_field :title_cont, class: "pull-right", placeholder: "Search..."  %>
              <% end %>
            <% else %>
              <%= search_form_for @search, html: { class: 'search' } do |f| %>
                <%= f.text_field :title_or_description_cont, class: "pull-right", 
                                 placeholder: "Search..."  %>
              <% end %>
            <% end %>
          </nav><!-- /sub-nav -->

          <div class="clearfix"></div>
        </div><!-- /page-header -->

        <% if user_signed_in? %>
          <%= render "layouts/admin_navigation" %>
        <% end %>
      
        <div class="span11">
        <% if notice %>
          <div class="alert alert-success">
            <%= notice %>
          </div>
        <% end %>
        <% if alert && (params[:controller] != "sessions") %>
          <div class="alert">
            <%= alert %>
          </div>
        <% end %>
        </div>

        <% if content_for?(:banner) %>
          <div class="span11">
            <div class="hero-unit" id="banner">
              <%= yield(:banner) %>
            </div><!-- /hero-unit -->
            <% if content_for?(:banner_alt) %>
              <div class="hero-unit" id="banner_alt">
                <%= yield(:banner_alt) %>
              </div><!-- /hero-unit -->
            <% end %>
          </div><!-- /span -->
        <% end %>

        <%= @sidebar ? raw("<div class=\"span7\">") : raw("<div class=\"span11\">") %>
          <%= yield %>
        </div><!-- /span -->

        <% if @sidebar %>
          <div class="span4" id="sidebar">
            <%= render @sidebar %>
          </div><!-- /span4 -->
        <% end %>

		  </div><!-- /row -->
	 </div><!-- /container -->

    <div class="footer">
      <div class="container">
        <p>Copyright © <%= Date.today.strftime("%Y") %> <%= settings.site_name %>
          <% cache "footer_pages" do %>
            <% footer_pages.each do |page| %> 
              | <%= link_to page.title, page %>
            <% end %>
          <% end %>
        </p>
      </div><!-- /container -->
    </div><!-- /footer -->

  </div><!-- holder -->

  <% if settings.gauges.present? %> 
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '<%= settings.gauges %>');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  <% end %>

</body>
</html>